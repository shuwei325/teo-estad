<!DOCTYPE html>
<html lang="es"><head>
<script src="Clase_07_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clase_07_files/libs/quarto-html/tabby.min.js"></script>
<script src="Clase_07_files/libs/quarto-html/popper.min.js"></script>
<script src="Clase_07_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Clase_07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clase_07_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Clase_07_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Shu Wei Chou Chen">
  <title>Estimación Puntual4</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Clase_07_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Clase_07_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="Clase_07_files/libs/revealjs/dist/theme/quarto-829c66079de1ba6dba869a367cd4b667.css">
  <link href="Clase_07_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Clase_07_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Clase_07_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Clase_07_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Estimación Puntual<sup>4</sup></h1>
  <p class="subtitle"><a href="https://swchouchen.github.io/teo-estad">Curso: Teoría Estadística</a></p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<a href="https://shuwei325.github.io">Shu Wei Chou Chen</a> <a href="https://orcid.org/0000-0001-5495-2486" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
</div>
<div class="quarto-title-author-email">
<a href="mailto:shuwei.chou@ucr.ac.cr">shuwei.chou@ucr.ac.cr</a>
</div>
        <p class="quarto-title-affiliation">
            <a href="https://www.estadistica.ucr.ac.cr/">
            Escuela de Estadística, Universidad de Costa Rica
            </a>
          </p>
    </div>
</div>

</section>
<section>
<section id="qué-vamos-a-discutir-hoy" class="title-slide slide level1 center">
<h1>¿Qué vamos a discutir hoy?</h1>
<ul>
<li>Estimadores de momentos</li>
<li>Estimador de máxima verosimilitud (EMV)</li>
</ul>
</section>
<section id="estimadores-de-momentos" class="slide level2">
<h2>Estimadores de momentos</h2>
<p><strong>Definición 2.8:</strong> <em>Momento al origen</em>. Si <span class="math inline">\(X\)</span> es una variable aleatoria con distribución conocida, se define el <span class="math inline">\(k\)</span>-ésimo momento al origen como: <span class="math inline">\(\mu_{k}^{\prime} = E\left[X^{k}\right]\)</span></p>
<p><strong>Definición 2.9:</strong> <em>Momento central</em>. Si <span class="math inline">\(X\)</span> es una variable aleatoria con distribución conocida y media <span class="math inline">\(\mu\)</span>, se define el <span class="math inline">\(k\)</span>-ésimo momento central como: <span class="math display">\[\mu_{k} = E\left[(X-\mu)^{k}\right]\]</span> Para este tema también vamos a definir un nuevo tipo de momento, que llamaremos momento muestral:</p>
<p><strong>Definición 2.10:</strong> <em>Momento muestral</em>. Si <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> es una muestra aleatoria de una distribución conocida, entonces se define el <span class="math inline">\(k\)</span>-ésimo momento muestral como: <span class="math display">\[m_{k}^{\prime} = \frac{1}{n} \sum_{j=1}^{n} X_{j}^{k}\]</span></p>
</section>
<section class="slide level2">

<p>Si nos basamos en la idea de que los momentos muestrales son buenos estimadores de los momentos poblaciones al origen, entonces para determinar el estimador de momentos (EM) en relación con un parámetro desconocido <span class="math inline">\(\theta\)</span>, se resuelve la ecuación generada al igualar el momento (o momentos) poblacional al origen con el momento muestral y resolviendo para <span class="math inline">\(\theta\)</span>.</p>
</section>
<section class="slide level2">

<p><strong>Ejemplo.</strong> Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria tal que <span class="math inline">\(X_{j} \sim Unif(0, \theta)\)</span>. Encuentre el estimador de momentos para <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Solución.</strong> Empezando por el momento al origen tenemos: <span class="math display">\[\mu_{1}^{\prime} = E\left[X^{1}\right] = E[X] = \frac{\theta}{2}\]</span></p>
<p>El primer momento muestral siempre va a ser <span class="math inline">\(\overline{X}\)</span> por lo que en este caso tenemos la siguiente igualdad:</p>
<p><span class="math display">\[\mu_{1}^{\prime} = m_{1}^{\prime}\]</span></p>
<p><span class="math display">\[\Rightarrow \frac{\theta}{2} = \overline{X}\]</span></p>
<p><span class="math display">\[\Rightarrow \hat{\theta} = 2\overline{X}\]</span></p>
<p>Por lo tanto concluimos que <span class="math inline">\(\hat{\theta} = 2\overline{X}\)</span> es el estimador de momentos para <span class="math inline">\(\theta\)</span>. Se puede demostrar que este es un estimador insesgado y consistente para <span class="math inline">\(\theta\)</span>.</p>
</section>
<section class="slide level2">

<p><strong>Ejemplo.</strong> Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria tal que <span class="math inline">\(X_{j} \sim Gamma(\alpha, \beta)\)</span>. Determine un estimador de momentos para <span class="math inline">\(\alpha\)</span> y para <span class="math inline">\(\beta\)</span>.</p>
<p><strong>Solución.</strong> En el los casos en que se requiere estimar más de un parámetro se debe utilizar un número de igualdades similar al número de parámetros desconocidos. En este caso tenemos:</p>
<p><span class="math display">\[\begin{array}{ll} \mu_{1}^{\prime} = E(X) = \alpha\beta &amp; m_{1}^{\prime} = \overline{X} \\ \mu_{2}^{\prime} = E(X^{2}) = \alpha \beta^{2} + (\alpha\beta)^{2} &amp; m_{2}^{\prime} = \frac{1}{n} \sum_{j=1}^{n} X_{j}^{2} = \overline{X^2} \end{array}\]</span></p>
<p>Ahora debemos resolver el siguiente sistema de ecuaciones:</p>
<p><span class="math display">\[\alpha\beta = \overline{X}\]</span> <span class="math display">\[\alpha \beta^{2} + (\alpha\beta)^{2}  = \overline{X^2}\]</span></p>
</section>
<section class="slide level2">

<p>Podemos sustituir <span class="math inline">\(\alpha\beta\)</span> de la primera ecuación en la segunda y despejar <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[\overline{X}\beta + {\overline{X}}^{2} = \overline{X^2}\]</span></p>
<p><span class="math display">\[\Rightarrow \hat{\beta} = \frac{\overline{X^2} - {\overline{X}}^{2}}{\overline{X}}\]</span></p>
</section>
<section class="slide level2">

<p>Sustituyendo este resultado en la primera ecuación podemos obtener que</p>
<p><span class="math display">\[\hat{\alpha} = \frac{{\overline{X}}^{2}}{\overline{X^2} - {\overline{X}}^{2}}\]</span></p>
<p>Concluimos que <span class="math inline">\(\hat{\alpha}\)</span> y <span class="math inline">\(\hat{\beta}\)</span> son los estimadores de momentos de <span class="math inline">\(\alpha\)</span> y <span class="math inline">\(\beta\)</span> respectivamente.</p>
<p>Si se quisieran simplificar un poco estas expresiones se puede demostrar que</p>
<p><span class="math display">\[\hat{\alpha} = \frac{n{\overline{X}}^{2}}{(n-1)S^{2}}\]</span></p>
<p><span class="math display">\[\hat{\beta} = \frac{(n-1)S^{2}}{n\overline{X}}\]</span></p>
</section>
<section id="estimadores-de-máxima-verosimilitud" class="slide level2">
<h2>Estimadores de máxima verosimilitud</h2>
<p>Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria sobre una población con distribución que incluye parámetros <span class="math inline">\(\theta_{1}, \theta_{2}, ... , \theta_{k}\)</span>. La función de verosimilitud <span class="math inline">\(\mathcal{L}(x_{1}, ... , x_{n}|\theta_{1}, \theta_{2}, ... , \theta_{k})\)</span>, mejor expresada como <span class="math inline">\(\mathcal{L}(\theta_{1}, \theta_{2}, ... , \theta_{k})\)</span>, se dice que es una función de los parámetros para un específico resultado de la muestra aleatoria.</p>
<p><strong>Ejemplo.</strong> Suponga que tenemos una función de densidad discreta (que toma valores 1, 2, 3 y 4) que depende de un parámetro <span class="math inline">\(\theta\)</span> que solo puede tomar tres valores (0,1,2). Su función de probabilidad viene dada en la siguiente tabla:</p>
<p>Función de probabilidad</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>y</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(f(y;\theta)\)</span></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(f(y;0)\)</span></td>
<td>.980</td>
<td>.005</td>
<td>.005</td>
<td>.010</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(f(y;1)\)</span></td>
<td>.100</td>
<td>.200</td>
<td>.200</td>
<td>.500</td>
</tr>
<tr class="even">
<td><span class="math inline">\(f(y;2)\)</span></td>
<td>.098</td>
<td>.001</td>
<td>.001</td>
<td>.900</td>
</tr>
</tbody>
</table>
</section>
<section class="slide level2">

<p>Supongamos que obtuvimos una muestra aleatoria de tamaño cuatro donde observamos los siguientes datos: 4,4,3,4. ¿Cuál es el valor de <span class="math inline">\(\theta\)</span> que máximiza la función de verosimilitud?</p>
<p><strong>Solución</strong>. Debemos obtener la verosmilitud para la muestra obtenida para cada uno de los valores de <span class="math inline">\(\theta\)</span>. El valor de <span class="math inline">\(\theta\)</span> que genere la máxima verosimilitud será el estimador de máxima verosimilitud.</p>
<p>Recordemos que la función de verosimilitud es la probabilidad conjunta de la muestra observada. En este caso viene dada por:</p>
<p><span class="math display">\[\begin{align*}
\mathcal{L}(\theta) = P(Y=4|\theta) \cdot P(Y=4|\theta) \cdot P(Y=3|\theta) \cdot P(Y=4|\theta)
&amp;= P(Y=4|\theta)^{3} \cdot P(Y=3|\theta)
\end{align*}\]</span> Debemos encontrar este valor para cada uno de los posibles valores de <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[\mathcal{L}(0) = (0.010)^{3} \cdot (0.005) = 5 \cdot 10^{-09}\]</span> <span class="math display">\[\mathcal{L}(1) = (0.500)^{3} \cdot (0.200) = 0.025\]</span> <span class="math display">\[\mathcal{L}(2) = (0.900)^{3} \cdot (0.001) = 0.00729\]</span></p>
</section>
<section class="slide level2">

<p>En este caso obtenemos la mayor verosimilitud cuando <span class="math inline">\(\theta=1\)</span>, por lo tanto el estimador de máxima verosimilitud sería <span class="math inline">\(\hat{\theta} = 1\)</span>.</p>
<p>En el caso en que <span class="math inline">\(\theta\)</span> sea una variable cuyo dominio es continuo, para encontrar el estimador de <span class="math inline">\(\theta\)</span> basta con optimizar la verosimilitud siempre que existan los máximos correspondientes.</p>
<p><strong>Ejemplo.</strong> Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria tal que <span class="math inline">\(X_{j} \sim Bernoulli(p)\)</span>. Determinar el estimador de máxima verosimilitud (EMV) para <span class="math inline">\(p\)</span>.</p>
<p><strong>Solución.</strong> Ya anteriormente habiamos obtenido la función de verosimilitud de una muestra aleatoria Bernoulli,</p>
<p><span class="math inline">\(\mathcal{L}(p) = p^{u}(1-p)^{n-u} \quad donde \quad u = \sum_{j=1}^{n} x_{j}\)</span></p>
</section>
<section class="slide level2">

<p>Derivamos esta función con respecto a <span class="math inline">\(p\)</span> e igualamos a cero. No obstante podemos notar como esto va a ser un proceso tedioso pues existe un producto de distintas funciones de <span class="math inline">\(p\)</span>. Para facilitar este cálculo podemos utilizar una propiedad matemática que establece que si <span class="math inline">\(f(x)\)</span> tiene un punto extremo en <span class="math inline">\(x_0\)</span> y <span class="math inline">\(f(x) &gt; 0\)</span> entonces <span class="math inline">\(\ln f(x)\)</span> también tiene un valor extremo en <span class="math inline">\(x_0\)</span>. Por lo tanto podemos hacer uso de la <em>log-verosimilitud</em>:</p>
<p><span class="math display">\[\ell(p) = \ln \mathcal{L}(p) = u\ln p + (n-u) \ln (1-p)\]</span></p>
<p><span class="math display">\[\Rightarrow \frac{\partial \ln \mathcal{L}}{\partial p} =  \frac{u}{p} - \frac{n-u}{1-p} = 0 \Rightarrow \frac{u(1-p) - p(n-u)}{p(1-p)} = 0\]</span></p>
<p><span class="math display">\[\Rightarrow u - up - np + up = 0 \Rightarrow u = np \Rightarrow \hat{p} = \frac{u}{n} = \frac{\sum_{j=1}^{n} x_{j} }{n}\]</span></p>
<p>El valor crítico es <span class="math inline">\(\hat{p} = \frac{\sum_{j=1}^{n} x_{j} }{n}\)</span> pero falta demostrar que efectivamente sea un máximo.</p>
</section>
<section class="slide level2">

<p>Su segunda derivada es:</p>
<p><span class="math display">\[\frac{\partial^{2} \ln \mathcal{L}}{\partial p^{2}} = \frac{-u}{p^2} - \frac{n-u}{(1-p)^2} &lt; 0,\]</span> cuando <span class="math inline">\(p= \hat{p}\)</span>.</p>
<p>Por lo tanto, concluimos que <span class="math inline">\(\hat{p}\)</span> es el estimador de máxima verosimilitud.</p>
</section>
<section class="slide level2">

<p><strong>Ejemplo.</strong> Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria tal que <span class="math inline">\(X_{j} \sim N(\mu, \sigma^2)\)</span>. Encuentre los estimadores máximo-verosímiles para <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma^2\)</span>.</p>
<p><strong>Solución.</strong> Para no confunidr la notación, tome <span class="math inline">\(\omega=\sigma^2\)</span>. Empezemos por obtener la función de verosimilitud:</p>
<p><span class="math display">\[\mathcal{L}(\mu, \omega) = \prod_{j=1}^{n} \frac{1}{\sqrt{2\pi\omega}} e^{-\frac{(x_{j}-\mu)^2}{2\omega}}= (2\pi)^{-\frac{n}{2}} (\omega)^{-\frac{n}{2}} e^{-\frac{\sum(x_{j} -\mu)^2}{2\omega}}\]</span></p>
<p>Obtenindo la log-verosimilitud:</p>
<p><span class="math display">\[\ell(\mu, \omega) = -\frac{n}{2} \ln(2\pi) -\frac{n}{2} \ln(\omega) -\frac{\sum(x_{j} -\mu)^2}{2\omega}\]</span></p>
</section>
<section class="slide level2">

<p>Derivando con respecto a <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[\frac{\partial \ell(\mu,\omega)}{\partial \mu} = \frac{\sum(x_{j} -\mu)}{\omega} = 0 \Rightarrow \sum(x_{j} -\mu) = 0 \Rightarrow \hat{\mu} = \overline{X}\]</span></p>
<p>Su segunda deivada es <span class="math inline">\(\frac{\partial^{2} \ell(\mu,\omega)}{\partial \mu^{2}} = -\frac{n}{\omega} &lt; 0\)</span></p>
<p>Ahora procedemos a derivar con respecto a <span class="math inline">\(\omega\)</span>.</p>
<p><span class="math display">\[\frac{\partial \ell(\mu,\omega)}{\partial \omega} = -\frac{n}{2\omega} + \frac{\sum(x_{j} -\mu)^2}{2\omega^2} = \frac{-n\omega + \sum(x_{j} -\mu)^2}{2\omega^2} = 0\]</span></p>
<p><span class="math display">\[\Rightarrow \sum(x_{j} -\mu)^2 = n\omega \Rightarrow \hat{\omega} = \hat{\sigma}^{2} = \frac{\sum(x_{j} -\mu)^2}{n}\]</span></p>
<p><span class="math display">\[\frac{\partial^{2} \ell(\mu,\sigma^2)}{\partial \omega^{2}} = \frac{n}{2\omega^2} - \frac{\sum(x_{j} -\mu)^2}{\omega^3} &lt; 0 \quad \text{, cuando} \quad \omega = \frac{\sum(x_{j} -\mu)^2}{n}\]</span></p>
</section>
<section class="slide level2">

<p>Nótese que este estimador está en términos de un parámetro desconocido, <span class="math inline">\(\mu\)</span>, por lo que podemos sustituirlo por su respectivo estimador de máxima verosimilitud. Por lo tanto obtenemos el estimador <span class="math display">\[\hat{\sigma}^{2} = \frac{\sum(x_{j} -\overline{X})^2}{n} = \frac{(n-1)}{n} S^{2}\]</span></p>
<p>Concluimos que <span class="math inline">\(\overline{X}\)</span> y <span class="math inline">\(\frac{(n-1)}{n} S^{2}\)</span> son los estimadores de máxima verosimilitud de <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma^2\)</span>, respectivamente.</p>
</section>
<section class="slide level2">

<p>Otra posibilidad es considerar la función de verosimilitud con dos parámetros desconocidos (<span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma^2\)</span>), es decir una función bivariada.</p>
<p>Tenemos que <span class="math display">\[\frac{\partial^{2} \ell(\mu,\omega)}{\partial \mu^{2}} = -\frac{n}{\sigma^2},~~~~~~~~~~~\frac{\partial^{2} \ell(\mu,\omega)}{\partial \omega^{2}} = \frac{n}{2\omega^2} - \frac{\sum(x_{j} -\mu)^2}{\omega^3}\]</span></p>
<p><span class="math display">\[\text{y}~~~\frac{\partial^{2} \ell(\mu,\omega)}{\partial \mu \partial \omega} =  - \frac{\sum(x_{j} -\mu)}{\omega^2}\]</span> La matriz hessiana es</p>
<p><span class="math display">\[ \begin{bmatrix}
   -\frac{n}{\omega} &amp; - \frac{\sum(x_{j} -\mu)}{\omega^2} \\
   - \frac{\sum(x_{j} -\mu)}{\omega^2} &amp; \frac{n}{2\omega^2} - \frac{\sum(x_{j} -\mu)^2}{\omega^3}
   \end{bmatrix}  \]</span></p>
</section>
<section class="slide level2">

<p>El determinante de la matriz hessiana evaluada en <span class="math inline">\((\mu=\hat{\mu},~\omega=\hat{\omega})\)</span> es:</p>
<p><span class="math display">\[ \left| \begin{bmatrix}
   -\frac{n}{\omega} &amp; - \frac{\sum(x_{j} -\mu)}{\omega^2} \\
   - \frac{\sum(x_{j} -\mu)}{\omega^2} &amp; \frac{n}{2\omega^2} - \frac{\sum(x_{j} -\mu)^2}{\omega^3}
   \end{bmatrix}  \right|_{(\mu=\hat{\mu},~\omega=\hat{\omega})}\]</span> <span class="math display">\[=\left. \frac{1}{\omega^3}\left[ \frac{-n^2}{2} + \frac{n}{\omega}\sum_{i=1}^n (x_i-\mu)^2 - \frac{1}{\omega}\left( \sum_{i=1}^n (x_i-\mu) \right)^2 \right]\right|_{(\mu=\hat{\mu},~\omega=\hat{\omega})}\]</span> <span class="math display">\[=\frac{1}{\hat{\omega}^3} \left[  \frac{-n^2}{2} + n^2 \right]= \frac{n^2}{2\hat{ \omega}^3}&gt;0.\]</span> El determinante de la matriz hessiana es positivo, entonces el punto crítico encontrado es máximo o mínimo (no es punto de silla). Luego, para mostrar que es un máximo local, basta mostrar que las segundas derivadas parciales son negativas (ya se mostró anteriormente).</p>
</section>
<section class="slide level2">

<p><strong>Ejemplo.</strong> Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria tal que <span class="math inline">\(X_{j} \sim Unif(0, \theta)\)</span>. Encuentre el estimador de máxima verosimilitud de <span class="math inline">\(\theta\)</span>.</p>
<p><strong>Solución.</strong> Empezemos por obtener la función de verosimilitud y log-verosimilitud:</p>
<p><span class="math display">\[\mathcal{L}(\theta) = \prod_{j=1}^{n} \frac{1}{\theta} = \theta^{-n}\]</span></p>
<p><span class="math display">\[\ell(\theta) = -n \ln\theta\]</span></p>
<p>Derivando con respecto a <span class="math inline">\(\theta\)</span>:</p>
<p><span class="math display">\[\frac{\partial \ell (\theta)}{\partial \theta} = \frac{-n}{\theta} &lt; 0\]</span></p>
</section>
<section class="slide level2">

<p>Esto significa que <span class="math inline">\(\ell (\theta)\)</span> no tiene puntos críticos pero sí podemos encontrar un máximo local. Como es una función decreciente sabemos que el máximo se encuentra en el valor mínimo que <span class="math inline">\(\theta\)</span> puede tomar. Recordemos que la verosimilitud es una función de <span class="math inline">\(\theta\)</span> para un resultado específico de la muestra aleatoria, por lo que los valores de <span class="math inline">\(\theta\)</span> van a depender de los valores de la muestra aleatoria. Siendo <span class="math inline">\(\theta\)</span> el máximo poblacional es lógico pensar que para una muestra aleatoria dada lo mínimo que puede ser este valor es el máximo muestral <span class="math inline">\(X_{(n)}\)</span>. Por lo tanto, concluimos que el estimador de máxima verosimilitud de <span class="math inline">\(\theta\)</span> es <span class="math inline">\(X_{(n)}\)</span>.</p>
</section>
<section class="slide level2">


<img data-src="figs/maxvero.jpg" class="r-stretch quarto-figure-center"><p class="caption">Figura 4. Verosimilitud de una <span class="math inline">\(Unif(0,\theta)\)</span> a partir de una muestra aleatoria.</p></section>
<section id="propiedades-de-los-estimadores-de-máxima-verosimilitud" class="slide level2">
<h2>Propiedades de los estimadores de máxima verosimilitud</h2>
<ul>
<li>Si <span class="math inline">\(\mathcal{L}(\theta)\)</span> es función de verosimilitud entonces para un estadístico suficiente <span class="math inline">\(U = T(X_{1}, X_{2}, ... , X_{n})\)</span> para estimar <span class="math inline">\(\theta\)</span> se cumple,</li>
</ul>
<p><span class="math display">\[\mathcal{L}(\theta) = g(u,\theta)\cdot h(x_{1}, x_{2}, ... , x_{n})\]</span> <span class="math display">\[\Rightarrow \ell(\theta) = \ln(g(u,\theta)) + \ln(h(x_{1}, x_{2}, ... , x_{n}))\]</span> <span class="math display">\[\Rightarrow \frac{\partial \ell(\theta)}{\partial \theta} = \frac{g^{\prime}(u,\theta)}{g(u,\theta)}\]</span></p>
<p>Con lo anterior se demuestra que el EMV de <span class="math inline">\(\theta\)</span> debe ser función de <span class="math inline">\(U\)</span>. Por el Teorema de Rao-Blackwell se cumple que son estimadores de variancia mínima.</p>
<ul>
<li>Se puede demostrar que los EMV son asintóticamente insesgados.</li>
</ul>
<p><strong>Teorema 2.11:</strong> <em>Principio de Invariancia:</em> Si <span class="math inline">\(\hat{\theta}\)</span> es EMV de <span class="math inline">\(\theta\)</span> y <span class="math inline">\(t(\theta)\)</span> es una función inyectiva de <span class="math inline">\(\theta\)</span> entonces <span class="math inline">\(t(\hat{\theta})\)</span> es el EMV de <span class="math inline">\(t(\theta)\)</span>.</p>
</section>
<section class="slide level2">

<p><strong>Ejemplo.</strong> Sea <span class="math inline">\(X_{1}, X_{2}, ... , X_{n}\)</span> una muestra aleatoria Normal con <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma^2\)</span> desconocidos. Encuentre el EMV de <span class="math inline">\(\sigma\)</span>.</p>
<p><strong>Solución.</strong> Se demostró con anterioridad que <span class="math inline">\(\hat{\sigma}^{2} = \frac{(n-1)}{n} S^{2}\)</span> es el EMV para <span class="math inline">\(\sigma^2\)</span>. Sabiendo que la función <span class="math inline">\(t(x) = \sqrt{x}\)</span> es continua en los reales positivos entonces por la propiedad de Invariancia se cumple que <span class="math inline">\(\sqrt{(\hat{\sigma^{2}})} = \sqrt{\frac{(n-1)}{n}}S\)</span> es el EMV de <span class="math inline">\(\sigma\)</span>.</p>
</section>
<section id="ejercicios" class="slide level2">
<h2>Ejercicios</h2>
<p>9.80 Suponga que <span class="math inline">\(Y_1, Y_2, . . . , Y_n\)</span> denotan una muestra aleatoria de la distribución de Poisson con media <span class="math inline">\(\lambda\)</span>.</p>
<ol type="a">
<li><p>Encuentre el MLE <span class="math inline">\(\hat{\lambda}\)</span> para <span class="math inline">\(\lambda\)</span>.</p></li>
<li><p>Encuentre el valor esperado y la varianza de <span class="math inline">\(\hat{\lambda}\)</span>.</p></li>
<li><p>Demuestre que el estimador del inciso a es consistente para <span class="math inline">\(\lambda\)</span>.</p></li>
<li><p>¿Cuál es el MLE para <span class="math inline">\(P(Y = 0) = \exp{(–\lambda)}\)</span>?</p></li>
</ol>
<p>9.81 Suponga que <span class="math inline">\(Y_1, Y_2, . . . , Y_n\)</span> denotan una muestra aleatoria de una población distribuida exponencialmente con media <span class="math inline">\(\theta\)</span>. Encuentre el MLE de la varianza poblacional <span class="math inline">\(\theta^2\)</span>. [Sugerencia: recuerde el Ejemplo 9.9. de Mendenhall]</p>
<p>Suponga que <span class="math inline">\(X_1, X_2, . . . , X_n\)</span> es una m.a. de una población con densidad <span class="math inline">\(f(x|\beta)=\displaystyle \frac {x}{\beta}e^{ -\frac{x^2}{2\beta}}\)</span>, con <span class="math inline">\(x\geq 0, \ \beta &gt; 0\)</span>. Determine el MLE para <span class="math inline">\(\beta\)</span>.</p>
</section></section>
<section id="qué-discutimos-hoy" class="title-slide slide level1 center">
<h1>¿Qué discutimos hoy?</h1>
<p>Método de momentos. Método de máxima verosimilitud. Principio de invariancia.</p>
<ul>
<li>Estimadores de momentos</li>
<li>EMV</li>
<li>Propiedades del EMV</li>
</ul>

</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Clase_07_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Clase_07_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Clase_07_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Clase_07_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"right","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true,"width":"wide","numbers":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copiado");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copiado");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>